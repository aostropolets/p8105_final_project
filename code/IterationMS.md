IterationMS
================
Matthew Spotnitz
11/24/2021

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
    ## ✓ tibble  3.1.5     ✓ dplyr   1.0.7
    ## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
    ## ✓ readr   2.0.1     ✓ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(readxl)
library(haven)
library(ggplot2)
library(zipcodeR)
library(ggmap)
```

    ## Google's Terms of Service: https://cloud.google.com/maps-platform/terms/.

    ## Please cite ggmap if you use it! See citation("ggmap") for details.

``` r
library(leaflet)
library(kableExtra)
```

    ## 
    ## Attaching package: 'kableExtra'

    ## The following object is masked from 'package:dplyr':
    ## 
    ##     group_rows

I will define the iterators

``` r
path = "../data/csrs_final_tables_2006_KI.xls"
phrase = "STTR Kidney Transplant Data, August 2020 Release"
```

Function to read csv file

``` r
read_file = function(x){
  x = read_excel(path, sheet = "Table B1")
x = janitor::clean_names(x)
str(x)
return(x) 
}
```

Test the function

``` r
df_one = read_file(path)
```

    ## tibble [240 × 60] (S3: tbl_df/tbl/data.frame)
    ##  $ entire_name    : chr [1:240] "Center Name" "Children's of Alabama (ALCH)" "University of Alabama Hospital (ALUA)" "Birmingham VA Medical Center (ALVA)" ...
    ##  $ ctr_cd         : chr [1:240] "Center Code" "ALCH" "ALUA" "ALVA" ...
    ##  $ ctr_ty         : chr [1:240] "Center Type" "TX1" "TX1" "TX1" ...
    ##  $ release_date   : chr [1:240] "Release Date" "44046.791666666664" "44046.791666666664" "44046.791666666664" ...
    ##  $ org            : chr [1:240] "Organ" "KI" "KI" "KI" ...
    ##  $ wla_addcen_nc1 : chr [1:240] "New Listings" "13" "426" "36" ...
    ##  $ wla_addcen_nc2 : chr [1:240] "New Listings" "7" "447" "35" ...
    ##  $ wla_addcen_pcz : chr [1:240] "New Listings" "35" "26.766467066" "52.23880597" ...
    ##  $ wla_addcen_prz : chr [1:240] "New Listings" "41.814623235" "41.814623235" "41.814623235" ...
    ##  $ wla_addcen_puz : chr [1:240] "New Listings" "42.165757431999999" "42.165757431999999" "42.165757431999999" ...
    ##  $ wla_end_nc1    : chr [1:240] "On waitlist at end" "20" "1670" "67" ...
    ##  $ wla_end_nc2    : chr [1:240] "On waitlist at end" "12" "1166" "81" ...
    ##  $ wla_end_pcz    : chr [1:240] "On waitlist at end" "60" "69.820359281" "120.89552239" ...
    ##  $ wla_end_prz    : chr [1:240] "On waitlist at end" "95.994687544" "95.994687544" "95.994687544" ...
    ##  $ wla_end_puz    : chr [1:240] "On waitlist at end" "100.24608634000001" "100.24608634000001" "100.24608634000001" ...
    ##  $ wla_remdet_nc1 : chr [1:240] "Deteriorated" "0" "42" "3" ...
    ##  $ wla_remdet_nc2 : chr [1:240] "Deteriorated" "0" "50" "2" ...
    ##  $ wla_remdet_pcz : chr [1:240] "Deteriorated" "0" "2.994011976" "2.9850746269" ...
    ##  $ wla_remdet_prz : chr [1:240] "Deteriorated" "4.0682231232" "4.0682231232" "4.0682231232" ...
    ##  $ wla_remdet_puz : chr [1:240] "Deteriorated" "4.1735847565000004" "4.1735847565000004" "4.1735847565000004" ...
    ##  $ wla_remdied_nc1: chr [1:240] "Died" "2" "162" "3" ...
    ##  $ wla_remdied_nc2: chr [1:240] "Died" "0" "63" "3" ...
    ##  $ wla_remdied_pcz: chr [1:240] "Died" "0" "3.7724550898" "4.4776119403" ...
    ##  $ wla_remdied_prz: chr [1:240] "Died" "3.8235705298" "3.8235705298" "3.8235705298" ...
    ##  $ wla_remdied_puz: chr [1:240] "Died" "3.8316334597999999" "3.8316334597999999" "3.8316334597999999" ...
    ##  $ wla_remoth_nc1 : chr [1:240] "Other Reasons" "0" "379" "1" ...
    ##  $ wla_remoth_nc2 : chr [1:240] "Other Reasons" "2" "491" "0" ...
    ##  $ wla_remoth_pcz : chr [1:240] "Other Reasons" "10" "29.401197605" "0" ...
    ##  $ wla_remoth_prz : chr [1:240] "Other Reasons" "9.5344610653" "9.5344610653" "9.5344610653" ...
    ##  $ wla_remoth_puz : chr [1:240] "Other Reasons" "5.3723908918000003" "5.3723908918000003" "5.3723908918000003" ...
    ##  $ wla_remrec_nc1 : chr [1:240] "Recovered" "0" "0" "0" ...
    ##  $ wla_remrec_nc2 : chr [1:240] "Recovered" "0" "6" "0" ...
    ##  $ wla_remrec_pcz : chr [1:240] "Recovered" "0" "0.3592814371" "0" ...
    ##  $ wla_remrec_prz : chr [1:240] "Recovered" "0.1188312596" "0.1188312596" "0.1188312596" ...
    ##  $ wla_remrec_puz : chr [1:240] "Recovered" "0.19963630609999999" "0.19963630609999999" "0.19963630609999999" ...
    ##  $ wla_remtfer_nc1: chr [1:240] "Transferred to another center" "1" "3" "1" ...
    ##  $ wla_remtfer_nc2: chr [1:240] "Transferred to another center" "2" "1" "0" ...
    ##  $ wla_remtfer_pcz: chr [1:240] "Transferred to another center" "10" "0.0598802395" "0" ...
    ##  $ wla_remtfer_prz: chr [1:240] "Transferred to another center" "0.6221165944" "0.6221165944" "0.6221165944" ...
    ##  $ wla_remtfer_puz: chr [1:240] "Transferred to another center" "1.4409392789" "1.4409392789" "1.4409392789" ...
    ##  $ wla_remtxc_nc1 : chr [1:240] "Received deceased donor tx" "11" "170" "5" ...
    ##  $ wla_remtxc_nc2 : chr [1:240] "Received deceased donor tx" "7" "203" "7" ...
    ##  $ wla_remtxc_pcz : chr [1:240] "Received deceased donor tx" "35" "12.155688623" "10.447761194" ...
    ##  $ wla_remtxc_prz : chr [1:240] "Received deceased donor tx" "17.398294422" "17.398294422" "17.398294422" ...
    ##  $ wla_remtxc_puz : chr [1:240] "Received deceased donor tx" "16.302972801999999" "16.302972801999999" "16.302972801999999" ...
    ##  $ wla_remtxl_nc1 : chr [1:240] "Received living donor tx" "3" "84" "0" ...
    ##  $ wla_remtxl_nc2 : chr [1:240] "Received living donor tx" "4" "75" "0" ...
    ##  $ wla_remtxl_pcz : chr [1:240] "Received living donor tx" "20" "4.4910179641" "0" ...
    ##  $ wla_remtxl_prz : chr [1:240] "Received living donor tx" "5.5431287572" "5.5431287572" "5.5431287572" ...
    ##  $ wla_remtxl_puz : chr [1:240] "Received living donor tx" "6.7273481973000004" "6.7273481973000004" "6.7273481973000004" ...
    ##  $ wla_remtxoc_nc1: chr [1:240] "Transplanted at another center" "0" "68" "6" ...
    ##  $ wla_remtxoc_nc2: chr [1:240] "Transplanted at another center" "0" "62" "9" ...
    ##  $ wla_remtxoc_pcz: chr [1:240] "Transplanted at another center" "0" "3.7125748503" "13.432835821" ...
    ##  $ wla_remtxoc_prz: chr [1:240] "Transplanted at another center" "4.7113099399" "4.7113099399" "4.7113099399" ...
    ##  $ wla_remtxoc_puz: chr [1:240] "Transplanted at another center" "3.8711654015999999" "3.8711654015999999" "3.8711654015999999" ...
    ##  $ wla_st_nc1     : chr [1:240] "On waitlist at start" "24" "2152" "50" ...
    ##  $ wla_st_nc2     : chr [1:240] "On waitlist at start" "20" "1670" "67" ...
    ##  $ wla_st_pcz     : chr [1:240] "On waitlist at start" "100" "100" "100" ...
    ##  $ wla_st_prz     : chr [1:240] "On waitlist at start" "100" "100" "100" ...
    ##  $ wla_st_puz     : chr [1:240] "On waitlist at start" "100" "100" "100" ...
